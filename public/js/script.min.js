/*
 * A lightweight, dependency-free and responsive javascript plugin for particle backgrounds.
 *
 * @author Marc Bruederlin <hello@marcbruederlin.com>
 * @version 2.2.2
 * @license MIT
 * @see https://github.com/marcbruederlin/particles.js
 */
var Particles=function(window,document){"use strict";function particleCompareFunc(p1,p2){return p1.x<p2.x?-1:p1.x>p2.x?1:p1.y<p2.y?-1:p1.y>p2.y?1:0}var Plugin,Particle={};return Plugin=function(){function Plugin(){var _=this;_.defaults={responsive:null,selector:null,maxParticles:100,sizeVariations:3,showParticles:!0,speed:.5,color:"#000000",minDistance:120,connectParticles:!1},_.element=null,_.context=null,_.ratio=null,_.breakpoints=[],_.activeBreakpoint=null,_.breakpointSettings=[],_.originalSettings=null,_.storage=[],_.usingPolyfill=!1}return Plugin}(),Plugin.prototype.init=function(settings){var _=this;return _.options=_._extend(_.defaults,settings),_.originalSettings=JSON.parse(JSON.stringify(_.options)),_._animate=_._animate.bind(_),_._initializeCanvas(),_._initializeEvents(),_._registerBreakpoints(),_._checkResponsive(),_._initializeStorage(),_._animate(),_},Plugin.prototype.destroy=function(){var _=this;_.storage=[],_.element.remove(),window.removeEventListener("resize",_.listener,!1),window.clearTimeout(_._animation),cancelAnimationFrame(_._animation)},Plugin.prototype._initializeCanvas=function(){var devicePixelRatio,backingStoreRatio,_=this;return _.options.selector?(_.element=document.querySelector(_.options.selector),_.context=_.element.getContext("2d"),devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=_.context.webkitBackingStorePixelRatio||_.context.mozBackingStorePixelRatio||_.context.msBackingStorePixelRatio||_.context.oBackingStorePixelRatio||_.context.backingStorePixelRatio||1,_.ratio=devicePixelRatio/backingStoreRatio,_.element.width=_.element.offsetParent.clientWidth*_.ratio,"BODY"===_.element.offsetParent.nodeName?_.element.height=window.innerHeight*_.ratio:_.element.height=_.element.offsetParent.clientHeight*_.ratio,_.element.style.width="100%",_.element.style.height="100%",void _.context.scale(_.ratio,_.ratio)):(console.warn("particles.js: No selector specified! Check https://github.com/marcbruederlin/particles.js#options"),!1)},Plugin.prototype._initializeEvents=function(){var _=this;_.listener=function(){_._resize()}.bind(this),window.addEventListener("resize",_.listener,!1)},Plugin.prototype._initializeStorage=function(){var _=this;_.storage=[];for(var i=_.options.maxParticles;i--;)_.storage.push(new Particle(_.context,_.options))},Plugin.prototype._registerBreakpoints=function(){var breakpoint,currentBreakpoint,l,_=this,responsiveSettings=_.options.responsive||null;if("object"==typeof responsiveSettings&&null!==responsiveSettings&&responsiveSettings.length){for(breakpoint in responsiveSettings)if(l=_.breakpoints.length-1,currentBreakpoint=responsiveSettings[breakpoint].breakpoint,responsiveSettings.hasOwnProperty(breakpoint)){for(;l>=0;)_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint&&_.breakpoints.splice(l,1),l--;_.breakpoints.push(currentBreakpoint),_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].options}_.breakpoints.sort(function(a,b){return b-a})}},Plugin.prototype._checkResponsive=function(){var breakpoint,_=this,targetBreakpoint=!1,windowWidth=window.innerWidth;if(_.options.responsive&&_.options.responsive.length&&null!==_.options.responsive){targetBreakpoint=null;for(breakpoint in _.breakpoints)_.breakpoints.hasOwnProperty(breakpoint)&&windowWidth<=_.breakpoints[breakpoint]&&(targetBreakpoint=_.breakpoints[breakpoint]);null!==targetBreakpoint?(_.activeBreakpoint=targetBreakpoint,_.options=_._extend(_.options,_.breakpointSettings[targetBreakpoint])):null!==_.activeBreakpoint&&(_.activeBreakpoint=null,targetBreakpoint=null,_.options=_._extend(_.options,_.originalSettings))}},Plugin.prototype._refresh=function(){var _=this;_._initializeStorage(),_._draw()},Plugin.prototype._resize=function(){var _=this;_.element.width=_.element.offsetParent.clientWidth*_.ratio,"BODY"===_.element.offsetParent.nodeName?_.element.height=window.innerHeight*_.ratio:_.element.height=_.element.offsetParent.clientHeight*_.ratio,_.context.scale(_.ratio,_.ratio),clearTimeout(_.windowDelay),_.windowDelay=window.setTimeout(function(){_._checkResponsive(),_._refresh()},50)},Plugin.prototype._animate=function(){var _=this;_._draw(),_._animation=window.requestAnimFrame(_._animate)},Plugin.prototype.resumeAnimation=function(){var _=this;_._animation||_._animate()},Plugin.prototype.pauseAnimation=function(){var _=this;if(_._animation){if(_.usingPolyfill)window.clearTimeout(_._animation);else{var cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame;cancelAnimationFrame(_._animation)}_._animation=null}},Plugin.prototype._draw=function(){var _=this,element=_.element,parentWidth=element.offsetParent.clientWidth,parentHeight=element.offsetParent.clientHeight,showParticles=_.options.showParticles,storage=_.storage;"BODY"===element.offsetParent.nodeName&&(parentHeight=window.innerHeight),_.context.clearRect(0,0,element.width,element.height),_.context.beginPath();for(var i=storage.length;i--;){var particle=storage[i];showParticles&&particle._draw(),particle._updateCoordinates(parentWidth,parentHeight)}_.options.connectParticles&&(storage.sort(particleCompareFunc),_._updateEdges())},Plugin.prototype._updateEdges=function(){for(var _=this,minDistance=_.options.minDistance,sqrt=Math.sqrt,abs=Math.abs,storage=_.storage,storageLength=storage.length,i=0;storageLength>i;i++)for(var p1=storage[i],j=i+1;storageLength>j;j++){var distance,p2=storage[j],r=p1.x-p2.x,dy=p1.y-p2.y;if(distance=sqrt(r*r+dy*dy),abs(r)>minDistance)break;minDistance>=distance&&_._drawEdge(p1,p2,1.2-distance/minDistance)}},Plugin.prototype._drawEdge=function(p1,p2,opacity){var _=this,gradient=_.context.createLinearGradient(p1.x,p1.y,p2.x,p2.y),color1=this._hex2rgb(p1.color),color2=this._hex2rgb(p2.color);gradient.addColorStop(0,"rgba("+color1.r+","+color1.g+","+color1.b+","+opacity+")"),gradient.addColorStop(1,"rgba("+color2.r+","+color2.g+","+color2.b+","+opacity+")"),_.context.beginPath(),_.context.strokeStyle=gradient,_.context.moveTo(p1.x,p1.y),_.context.lineTo(p2.x,p2.y),_.context.stroke(),_.context.fill(),_.context.closePath()},Plugin.prototype._extend=function(source,obj){return Object.keys(obj).forEach(function(key){source[key]=obj[key]}),source},Plugin.prototype._hex2rgb=function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},Particle=function(context,options){var _=this,random=Math.random,speed=options.speed,color=options.color instanceof Array?options.color[Math.floor(Math.random()*options.color.length)]:options.color;_.context=context,_.options=options;var canvas=document.querySelector(options.selector);_.x=random()*canvas.offsetParent.clientWidth,"BODY"===canvas.offsetParent.nodeName?_.y=random()*window.innerHeight:_.y=random()*canvas.offsetParent.clientHeight,_.vx=random()*speed*2-speed,_.vy=random()*speed*2-speed,_.radius=random()*random()*options.sizeVariations,_.color=color,_._draw()},Particle.prototype._draw=function(){var _=this;_.context.save(),_.context.translate(_.x,_.y),_.context.moveTo(0,0),_.context.beginPath(),_.context.arc(0,0,_.radius,0,2*Math.PI,!1),_.context.fillStyle=_.color,_.context.fill(),_.context.restore()},Particle.prototype._updateCoordinates=function(parentWidth,parentHeight){var _=this,x=_.x+this.vx,y=_.y+this.vy,radius=_.radius;x+radius>parentWidth?x=radius:0>x-radius&&(x=parentWidth-radius),y+radius>parentHeight?y=radius:0>y-radius&&(y=parentHeight-radius),_.x=x,_.y=y},window.requestAnimFrame=function(){var _=this,requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return requestAnimationFrame?requestAnimationFrame:(_._usingPolyfill=!0,function(callback){return window.setTimeout(callback,1e3/60)})}(),new Plugin}(window,document);!function(){"use strict";"function"==typeof define&&define.amd?define("Particles",function(){return Particles}):"undefined"!=typeof module&&module.exports?module.exports=Particles:window.Particles=Particles}();